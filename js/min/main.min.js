function fillTable(){for(var t=$("#main tbody"),e=0,n=0;n<globalJSON.length;n++){var a=globalJSON[n],o=++e;console.log(a.name),t.append("<tr class='no-service no-print tr-title' data-node='"+o+"'><td></td><td class='td-title-name'><strong>"+a.name+"</strong></td><td></td><td></td><td></td></tr>");for(var l=0;l<a.services.length;l++){var i=a.services[l];console.log(i.type),++e,t.append("<tr class='no-print' data-node='"+e+"' data-pnode='"+o+"'><td>"+i.code+"</td><td class='td-name'>"+i.name+"</td><td class='count'></td><td class='price'>"+i.price+"</td><td>"+i.unit+"</td></tr>")}}}function collapseTable(){var t=$("#main tbody");t.find("tr").not(".no-service").hide(),$(".tr-title").click(function(){var e=$(this).data("node"),n=t.find("[data-pnode='"+e+"']");n.toggle()})}function getResult(){for(var t=$(".table tbody tr.success"),e=[],n=0;n<t.length;n++){var a=$(t[n]).find(".count").find("input").val();if(a>0){var o=+$(t[n]).find(".price").text(),l=o*a;e.push(l)}}for(var i=0,s=0;s<e.length;s++)i+=e[s];this._result=$("#result"),this._result.val(i)}$(function(){fillTable(),collapseTable(),$("input").val("");var t="<input type='number' class='service-count' value='1' min='1'>";$(".table tbody tr").on("click",".service-count",function(t){t.stopPropagation()}),$(".table tbody tr").on("change",".service-count",function(){getResult()}),$("#datepicker").datepicker({autoclose:!0,todayBtn:"linked",clearBtn:!0,todayHighlight:!0,language:"ru"}).datepicker("setDate",new Date),$(".table tbody tr:not(.no-service)").click(function(){$(this).toggleClass("success no-print");var e=$(this).find(".count");$(this).hasClass("success")?e.append(t):e.empty(),getResult()}),$("td").on("focus","input[type=number]",function(){$(this).on("mousewheel.disableScroll",function(t){t.preventDefault()})}),$("td").on("blur","input[type=number]",function(){$(this).off("mousewheel.disableScroll")})});